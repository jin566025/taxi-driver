$(function(){$(".list").on("click",".list-main",function(){var t=$(this).data("taskid"),s=$(this).data("typeid");setTimeout(function(){1==s?window.location.href="pages/my-order-list/order-ing1.html?taskId="+t:2==s?window.location.href="pages/my-order-list/order-ing2.html?taskId="+t:3==s?window.location.href="pages/my-order-list/order-ing3.html?taskId="+t:4==s?window.location.href="pages/my-order-list/order-ing4.html?taskId="+t:5==s&&(window.location.href="pages/my-order-list/order-ing5.html?taskId="+t)},100)});var s=999999999;function A(t,s,e,i){var a=t*Math.PI/180,d=e*Math.PI/180,r=a-d,l=s*Math.PI/180-i*Math.PI/180,n=2*Math.asin(Math.sqrt(Math.pow(Math.sin(r/2),2)+Math.cos(a)*Math.cos(d)*Math.pow(Math.sin(l/2),2)));return n*=6378.137,n=Math.round(1e4*n)/1e4}function L(t){var s=new Date(parseInt(t));return s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()+" "+s.getHours()+":"+s.getMinutes()+":"+s.getSeconds()}function e(t,s,e,i){$.ajax({type:"post",url:url_path+"/mission/byDriverList.json",async:!0,data:{driverId:t,appstate:s,pageNo:e,pageSize:i},dataType:"json",success:function(t){if(console.log(t),"成功"==t.msg)for(var s=t.listDTO,e=0;e<s.length;e++){var i,a,d,r,l,n,o,v,c,h,p=L(s[e].statrTime);2==s[e].state?(i="进行中",a="已为您开启了最佳配送路线"):1==s[e].state?a=i="不知道1":3==s[e].state?(i="已完成",a="当前还未对租客进行评价"):5==s[e].state&&(i="结算中",a="任务正在结算中");var g=s[e].deliveryAddressLatitude,f=s[e].deliveryAddressLongitude,y=s[e].taskAddressLatitude,u=s[e].taskAddressLongitude,m=sessionStorage.getItem("driverLat"),I=sessionStorage.getItem("driverLng"),x=(A(m,I,g,f)+1).toFixed(2),w=(A(g,f,y,u)+1).toFixed(2);w+="公里";var M=s[e].deliveryAddress,k=s[e].taskAddress;M||(M="未填写由司机决定",w="自定义公里",x="自定义"),h=s[e].award+s[e].reward,1==s[e].typeId?(d="lists-right3",r="送取件",l="红包",n=s[e].award,o="type1",v="",c=s[e].goodsType):2==s[e].typeId?(d="lists-right2",r="代购",l="垫资资金",(n=s[e].matmoney)||(n="未填"),o="type2",v="",c=s[e].message):3==s[e].typeId?(d="lists-right4",v="hide_cls",r="打车",o="type3",c=l=n="",h="0"):4==s[e].typeId?(d="lists-right3",v="hide_cls",r="日常代驾",n=s[e].award,l="红包",o="type4",c=""):5==s[e].typeId&&(d="lists-right4",v="hide_cls",r="包时代驾",o="type4",c=l=n="",h="0",M=s[e].taskAddress,x=(A(m,I,y,u)+1).toFixed(2),w="当前位置："+s[e].deliveryAddress,k=L(s[e].statrTime));var b='<div class="list-main"  data-typeId='+s[e].typeId+" data-taskId="+s[e].id+'><div class="order-list-time">接单时间：'+p+'</div><div class="list-main-container"><div class="status clearfix"><div class="status-left fl">'+i+'</div><div class="status-right fr">'+a+'</div></div><div class="lists-content flex-box"><div class="lists-left flex-box"><div class="lists-left-price"><a class="fuhao">￥</a><a class="price">'+h+'</a></div><div class="lists-left-detail"><div class="lists-left-detail-top '+v+'">'+c+"</div><br"+v+' /><div class="type '+o+'">'+r+'</div></div></div><div class="lists-right '+d+'"><p><a>￥</a><a class="lists-right2-price">'+n+"</a></p><p>"+l+'</p></div></div><div class="start-end flex-box"><div class="start-end-left flex-box"><a class="circles strat-circle"></a><div class="start-end-detail">'+M+'</div></div><div class="start-end-right">'+x+'公里</div></div><div class="start-end flex-box"><div class="start-end-left flex-box"><a class="circles end-circle"></a><div class="start-end-detail">'+k+'</div></div><div class="start-end-right">'+w+"</div></div></div>\t</div>";$(".list").append(b)}},error:function(){}})}e(driverId,0,1,s),$(".header-nav-div").click(function(){if($(this).hasClass("header-nav-div-active"));else{$(".list").html("");var t=$(this).index(".header-nav-div");$(".header-nav-div").removeClass("header-nav-div-active"),$(this).addClass("header-nav-div-active"),e(driverId,t,1,s)}})});